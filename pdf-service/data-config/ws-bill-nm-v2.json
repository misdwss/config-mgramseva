{
  "key": "ws-bill-nm-v2",
  "DataConfigs": {
    "serviceName": "mgramseva-common",
    "version": "1.0.0",
    "baseKeyPath": "$.BillAndDemand.*",
    "entityIdPath": "$.Bill[0].billNumber",
    "isCommonTableBorderRequired": true,
    "mappings": [
      {
        "topic": "common-pdf-generation-1",
        "mappings": [
          {
            "direct":
            [
              {
                "variable": "gpwsc_name",
                "value": {
                  "path": "PDF_STATIC_LABEL_WATER_GPWSC_NAME"
                },
                "type": "label",
                "localisation": {
                  "required": true,
                  "prefix": null,
                  "module": "mgramseva-common"
                }
              },
              {
                "variable": "GPWSC",
                "value": {
                  "path": "$.Bill[0].tenantId"
                },
                "localisation": {
                  "required": true,
                  "prefix": null,
                  "module": "mgramseva-common"
                }
              },
              {
                "variable": "connection_id",
                "value": {
                  "path": "PDF_STATIC_LABEL_WATER_BILL_CONNECTION_ID"
                },
                "type": "label",
                "localisation": {
                  "required": true,
                  "prefix": null,
                  "module": "mgramseva-common"
                }
              },
              {
                "variable": "consumer_name",
                "value": {
                  "path": "PDF_STATIC_LABEL_WATER_BILL_CONSUMER_NAME"
                },
                "type": "label",
                "localisation": {
                  "required": true,
                  "prefix": null,
                  "module": "mgramseva-common"
                }
              },
              {
                "variable": "consumer_mobileno",
                "value": {
                  "path": "PDF_STATIC_LABEL_WATER_BILL_CONSUMER_MOBILE_NO"
                },
                "type": "label",
                "localisation": {
                  "required": true,
                  "prefix": null,
                  "module": "mgramseva-common"
                }
              },
              {
                "variable": "consumer_address",
                "value": {
                  "path": "PDF_STATIC_LABEL_WATER_CONSUMER_ADDRESS"
                },
                "type": "label",
                "localisation": {
                  "required": true,
                  "prefix": null,
                  "module": "mgramseva-common"
                }
              },
              {
                "variable": "service_type",
                "value": {
                  "path": "PDF_STATIC_LABEL_WATER_SERVICE_TYPE"
                },
                "type": "label",
                "localisation": {
                  "required": true,
                  "prefix": null,
                  "module": "mgramseva-common"
                }
              },
              {
                "variable": "meter_no",
                "value": {
                  "path": "PDF_STATIC_LABEL_WATER_METER_NUMBER"
                },
                "type": "label",
                "localisation": {
                  "required": true,
                  "prefix": null,
                  "module": "mgramseva-common"
                }
              },
              {
                "variable": "meter_reading",
                "value": {
                  "path": "PDF_STATIC_LABEL_WATER_METER_READING"
                },
                "type": "label",
                "localisation": {
                  "required": true,
                  "prefix": null,
                  "module": "mgramseva-common"
                }
              },
              {
                "variable": "meter_reading_date",
                "value": {
                  "path": "PDF_STATIC_LABEL_WATER_METER_READING_DATE"
                },
                "type": "label",
                "localisation": {
                  "required": true,
                  "prefix": null,
                  "module": "mgramseva-common"
                }
              },
              {
                "variable": "bill_id",
                "value": {
                  "path": "PDF_STATIC_LABEL_WATER_BILL_ID"
                },
                "type": "label",
                "localisation": {
                  "required": true,
                  "prefix": null,
                  "module": "mgramseva-common"
                }
              },
              {
                "variable": "bill_period",
                "value": {
                  "path": "PDF_STATIC_LABEL_WATER_BILL_PERIOD"
                },
                "type": "label",
                "localisation": {
                  "required": true,
                  "prefix": null,
                  "module": "mgramseva-common"
                }
              },
              {
                "variable": "bill_issue_date",
                "value": {
                  "path": "PDF_STATIC_LABEL_WATER_BILL_ISSUE_DATE"
                },
                "type": "label",
                "localisation": {
                  "required": true,
                  "prefix": null,
                  "module": "mgramseva-common"
                }
              },
              {
                "variable": "water_charges",
                "value": {
                  "path": "PDF_STATIC_LABEL_WATER_CHARGES"
                },
                "type": "label",
                "localisation": {
                  "required": true,
                  "prefix": null,
                  "module": "mgramseva-common"
                }
              },
              {
                "variable": "water_arrears",
                "value": {
                  "path": "PDF_STATIC_LABEL_WATER_ARREARS"
                },
                "type": "label",
                "localisation": {
                  "required": true,
                  "prefix": null,
                  "module": "mgramseva-common"
                }
              },
              {
                "variable": "total_bill_amount",
                "value": {
                  "path": "PDF_STATIC_LABEL_WATER_TOTAL_BILL_AMOUNT"
                },
                "type": "label",
                "localisation": {
                  "required": true,
                  "prefix": null,
                  "module": "mgramseva-common"
                }
              },
              {
                "variable": "advance_adjusted_amount",
                "value": {
                  "path": "PDF_STATIC_LABEL_WATER_ADVANCE_ADJUSTED_AMOUNT"
                },
                "type": "label",
                "localisation": {
                  "required": true,
                  "prefix": null,
                  "module": "mgramseva-common"
                }
              },
              {
                "variable": "net_amount_due",
                "value": {
                  "path": "PDF_STATIC_LABEL_WATER_NET_AMOUNT_DUE"
                },
                "type": "label",
                "localisation": {
                  "required": true,
                  "prefix": null,
                  "module": "mgramseva-common"
                }
              },
              {
                "variable": "penalty_after_due_date",
                "value": {
                  "path": "PDF_STATIC_LABEL_WATER_PENALTY_AFTER_DUE_DATE"
                },
                "type": "label",
                "localisation": {
                  "required": true,
                  "prefix": null,
                  "module": "mgramseva-common"
                }
              },
              {
                "variable": "net_amount_due_with_penalty",
                "value": {
                  "path": "PDF_STATIC_LABEL_WATER_NET_AMOUNT_DUE_WITH_PENALTY"
                },
                "type": "label",
                "localisation": {
                  "required": true,
                  "prefix": null,
                  "module": "mgramseva-common"
                }
              },
              {
                "variable": "total_due",
                "value": {
                  "path": "PDF_STATIC_LABEL_WATER_TOTAL_DUE"
                },
                "type": "label",
                "localisation": {
                  "required": true,
                  "prefix": null,
                  "module": "mgramseva-common"
                }
              },
              {
                "variable": "amount_inwords",
                "value": {
                  "path": "PDF_STATIC_LABEL_WATER_AMOUNT_INWORDS"
                },
                "type": "label",
                "localisation": {
                  "required": true,
                  "prefix": null,
                  "module": "mgramseva-common"
                }
              },
              {
                "variable": "bill_note",
                "value": {
                  "path": "PDF_STATIC_LABEL_WS_BILL_NOTE"
                },
                "type": "label",
                "localisation": {
                  "required": true,
                  "prefix": null,
                  "module": "mgramseva-common"
                }
              },
              {
                "variable": "customer_rating",
                "value": {
                  "path": "PDF_STATIC_LABEL_WATER_CUSTOMER_RATING"
                },
                "type": "label",
                "localisation": {
                  "required": true,
                  "prefix": null,
                  "module": "mgramseva-common"
                }
              },
              {
                "variable": "quality_water_supply",
                "value": {
                  "path": "PDF_STATIC_LABEL_WATER_QUALITY_WATER_SUPPLY"
                },
                "type": "label",
                "localisation": {
                  "required": true,
                  "prefix": null,
                  "module": "mgramseva-common"
                }
              },
              {
                "variable": "adequate_water_supply",
                "value": {
                  "path": "PDF_STATIC_LABEL_WATER_ADEQUATE_WATER_SUPPLY"
                },
                "type": "label",
                "localisation": {
                  "required": true,
                  "prefix": null,
                  "module": "mgramseva-common"
                }
              },
              {
                "variable": "collections",
                "value": {
                  "path": "PDF_STATIC_LABEL_WATER_COLLECTIONS"
                },
                "type": "label",
                "localisation": {
                  "required": true,
                  "prefix": null,
                  "module": "mgramseva-common"
                }
              },
              {
                "variable": "new_demand",
                "value": {
                  "path": "PDF_STATIC_LABEL_WATER_NEW_DEMAND"
                },
                "type": "label",
                "localisation": {
                  "required": true,
                  "prefix": null,
                  "module": "mgramseva-common"
                }
              },
              {
                "variable": "actual_collections",
                "value": {
                  "path": "PDF_STATIC_LABEL_WATER_ACTUAL_COLLECTIONS"
                },
                "type": "label",
                "localisation": {
                  "required": true,
                  "prefix": null,
                  "module": "mgramseva-common"
                }
              },
              {
                "variable": "total_pending_collections",
                "value": {
                  "path": "PDF_STATIC_LABEL_WATER_TOTAL_PENDING_COLLECTIONS"
                },
                "type": "label",
                "localisation": {
                  "required": true,
                  "prefix": null,
                  "module": "mgramseva-common"
                }
              },
              {
                "variable": "expenditure",
                "value": {
                  "path": "PDF_STATIC_LABEL_WATER_EXPENDITURE"
                },
                "type": "label",
                "localisation": {
                  "required": true,
                  "prefix": null,
                  "module": "mgramseva-common"
                }
              },
              {
                "variable": "new_expenditure",
                "value": {
                  "path": "PDF_STATIC_LABEL_WATER_NEW_EXPENDITURE"
                },
                "type": "label",
                "localisation": {
                  "required": true,
                  "prefix": null,
                  "module": "mgramseva-common"
                }
              },
              {
                "variable": "actual_payments",
                "value": {
                  "path": "PDF_STATIC_LABEL_WATER_ACTUAL_PAYMENTS"
                },
                "type": "label",
                "localisation": {
                  "required": true,
                  "prefix": null,
                  "module": "mgramseva-common"
                }
              },
              {
                "variable": "total_pending_expenditure",
                "value": {
                  "path": "PDF_STATIC_LABEL_WATER_TOTAL_PENDING_EXPENDITURE"
                },
                "type": "label",
                "localisation": {
                  "required": true,
                  "prefix": null,
                  "module": "mgramseva-common"
                }
              },
              {
                "variable": "gp_watersupply_sanitation",
                "value": {
                  "path": "PDF_STATIC_LABEL_WATER_GP_WATER_SUPPLY_SANITATION"
                },
                "type": "label",
                "localisation": {
                  "required": true,
                  "prefix": null,
                  "module": "mgramseva-common"
                }
              },
              {
                "variable": "charges_bill",
                "value": {
                  "path": "PDF_STATIC_LABEL_WATER_CHARGES_BILL"
                },
                "type": "label",
                "localisation": {
                  "required": true,
                  "prefix": null,
                  "module": "mgramseva-common"
                }
              },
              {
                "variable": "breakup_pending_watercharges",
                "value": {
                  "path": "PDF_STATIC_LABEL_WATER_BREAKUP_PENDING_WATERCHARGES"
                },
                "type": "label",
                "localisation": {
                  "required": true,
                  "prefix": null,
                  "module": "mgramseva-common"
                }
              },
              {
                "variable": "water_id",
                "value": {
                  "path": "PDF_STATIC_LABEL_WATER_ID"
                },
                "type": "label",
                "localisation": {
                  "required": true,
                  "prefix": null,
                  "module": "mgramseva-common"
                }
              },
              {
                "variable": "month_summary",
                "value": {
                  "path": "PDF_STATIC_LABEL_WATER_PREVIOUS_MONTH_SUMMARY_NM"
                },
                "type": "label",
                "localisation": {
                  "required": true,
                  "prefix": null,
                  "module": "mgramseva-common"
                }
              },
              {
                "variable": "user_feedback",
                "value": {
                  "path": "PDF_STATIC_LABEL_WATER_USER_FEEDBACK"
                },
                "type": "label",
                "localisation": {
                  "required": true,
                  "prefix": null,
                  "module": "mgramseva-common"
                }
              },
              {
                "variable": "summary_of",
                "value": {
                  "path": "PDF_STATIC_LABEL_WATER_SUMMARY_OF"
                },
                "type": "label",
                "localisation": {
                  "required": true,
                  "prefix": null,
                  "module": "mgramseva-common"
                }
              },
              {
                "variable": "totalAmountDue",
                "value": {
                  "path": "$.AggregatedDemands.netdue"
                }
              },
              {
                "variable": "totalAmountDueWithPenalty",
                "value": {
                  "path": "$.AggregatedDemands.netDueWithPenalty"
                }
              },
              {
                "variable": "mobileNo",
                "value": {
                  "path": "$.Bill[0].mobileNumber"
                }
              },
              {
                "variable": "billNo",
                "value": {
                  "path": "$.Bill[0].billNumber"
                }
              },
              {
                "variable": "fromPeriod",
                "value": {
                  "path": "$.Bill[0].billDetails[0].fromPeriod"
                }
              },
              {
                "variable": "toPeriod",
                "value": {
                  "path": "$.Bill[0].billDetails[0].toPeriod"
                }
              },
              {
                "variable": "billIssueDate",
                "value": {
                  "path": "$.Bill[0].billDate"
                },
                "type": "date",
                "format":"DD/MM/YYYY HH:mm "
              },
              {
                "variable": "billDueDate",
                "value": {
                  "path": "$.Bill[0].billDetails[0].expiryDate"
                },
                "type": "date"
              },
              {
                "variable": "billdate",
                "value": {
                  "path": "$.Bill[0].billDate"
                },
                "type": "date"
              },
              {
                "variable": "propertyID",
                "value": {
                  "path": "$.Bill[0].consumerCode"
                }
              },
              {
                "variable": "waterCess",
                "value": {
                  "path": "$.Bill[0].billDetails[0].billAccountDetails[?(@.taxHeadCode == 'WS_WATER_CESS' || @.taxHeadCode == 'SW_SEWERAGE_CESS')].amount"
                }
              },
              {
                "variable": "ceilingDebit",
                "value": {
                  "path": "$.Bill[0].billDetails[0].billAccountDetails[?(@.taxHeadCode == 'PT_DECIMAL_CEILING_DEBIT')].amount"
                }
              },
              {
                "variable": "ceilingCredit",
                "value": {
                  "path": "$.Bill[0].billDetails[0].billAccountDetails[?(@.taxHeadCode == 'PT_DECIMAL_CEILING_CREDIT')].amount"
                }
              },
              {
                "variable": "consumerID",
                "value": {
                  "path": "$.Bill[0].consumerCode"
                }
              },
              {
                "variable": "date",
                "value": {
                  "path": "$.Bill[0].billDate"
                },
                "type": "date"
              },
              {
                "variable": "totalPayment",
                "value": {
                  "path": "$.Bill[0].billDetails[0].amountPaid"
                }
              },
              {
                "variable": "totalArrears",
                "value": {
                  "path":"$.AggregatedDemands.totalAreasWithPenalty"
                }
              },
              {
                "variable": "arrears",
                "value": {
                  "path":"$.AggregatedDemands.totalAreasWithPenalty"
                },
                "localisation": {
                  "required": true,
                  "prefix": null,
                  "module": "mgramseva-common"
                }
              },
              {
                "variable": "current_month_penalty",
                "value": {
                  "path":"$.AggregatedDemands.currentMonthPenalty"
                }
              }
            ]
          },
          {
            "derived": [
              {
                "variable":"waterquality_rate_value",
                "formula":"'{{waterquality_rate}}'=='NA'? 'NA' : '{{waterquality_rate}}/5'"
              },
              {
                "variable":"watersupply_rate_value",
                "formula":"('{{watersupply_rate}}' =='NA' || {{watersupply_rate}} ==0 )? 'NA' : '{{watersupply_rate}}/5'"
              },
              {
                "variable":"supplyregula_rate_value",
                "formula":"'{{supplyregula_rate}}'=='NA' ? 'NA' : '{{supplyregula_rate}}/5'"
              },
              {
                "variable":"address",
                "formula":"['{{doorHouseNo}}', '{{streetName}}', '{{mohalla}}'].filter(x=>x != 'NA').join(', ')"
              },
              {
                "variable":"advanceAdjustedAmount",
                "formula":"-{{advanceAdjustedAmountOne}}"
              },
              {
                "variable":"ws_charge_amt",
                "formula":"{{WCharge}}"
              },
              {
                "variable":"totalArrear",
                "formula":"{{totalArrears}}<0?0:{{totalArrears}}"
              },
              {
                "variable":"totalBillAmount",
                "formula":"{{ws_charge_amt}} + {{current_month_penalty}} + {{totalArrear}}"
              },
              {
                "variable":"netAmountDue",
                "formula":"{{totalAmountDue}}"
              },
              {
                "variable":"netAmountDueWithPenalty",
                "formula":"{{totalAmountDueWithPenalty}}"
              },
              {
                "variable":"penaltyDueDate",
                "formula":"{{billExpiry}}+{{demandIssuedDate}}",
                "type":"date"
              }
            ]
          }
        ]
      }
    ]
  }
}
